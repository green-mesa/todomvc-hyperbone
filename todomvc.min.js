!function(){function t(e,n,r){var i=t.resolve(e);if(null==i){r=r||e,n=n||"root";var o=new Error('Failed to require "'+r+'" from "'+n+'"');throw o.path=r,o.parent=n,o.require=!0,o}var s=t.modules[i];if(!s._resolving&&!s.exports){var a={};a.exports={},a.client=a.component=!0,s._resolving=!0,s.call(this,a.exports,t,a),delete s._resolving,s.exports=a.exports}return s.exports}t.modules={},t.aliases={},t.resolve=function(e){return t.modules.hasOwnProperty(e)?e:void 0},t.register=function(e,n){t.modules[e]=n},t.register("type",function(t,e,n){var r=Object.prototype.toString;n.exports=function(t){switch(r.call(t)){case"[object Function]":return"function";case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object String]":return"string"}return null===t?"null":void 0===t?"undefined":t&&1===t.nodeType?"element":t===Object(t)?"object":typeof t}}),t.register("event",function(t){t.bind=function(t,e,n,r){return t.addEventListener?t.addEventListener(e,n,r):t.attachEvent("on"+e,n),n},t.unbind=function(t,e,n,r){return t.removeEventListener?t.removeEventListener(e,n,r):t.detachEvent("on"+e,n),n}}),t.register("delegate",function(t,e){var n=e("matches-selector"),r=e("event");t.bind=function(t,e,i,o,s){return r.bind(t,i,function(t){n(t.target,e)&&o(t)},s)},t.unbind=function(t,e,n,i){r.unbind(t,e,n,i)}}),t.register("indexof",function(t,e,n){n.exports=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}}),t.register("domify",function(t,e,n){function r(t){if("string"!=typeof t)throw new TypeError("String expected");var e=/<([\w:]+)/.exec(t);if(!e)throw new Error("No elements were generated.");var n=e[1];if("body"==n){var r=document.createElement("html");return r.innerHTML=t,r.removeChild(r.lastChild)}var o=i[n]||i._default,s=o[0],a=o[1],u=o[2],r=document.createElement("div");for(r.innerHTML=a+t+u;s--;)r=r.lastChild;var l=r.children;if(1==l.length)return r.removeChild(l[0]);for(var c=document.createDocumentFragment();l.length;)c.appendChild(r.removeChild(l[0]));return c}n.exports=r;var i={option:[1,'<select multiple="multiple">',"</select>"],optgroup:[1,'<select multiple="multiple">',"</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tbody:[1,"<table>","</table>"],tfoot:[1,"<table>","</table>"],colgroup:[1,"<table>","</table>"],caption:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],th:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:[0,"",""]}}),t.register("classes",function(t,e,n){function r(t){this.el=t,this.list=t.classList}var i=e("indexof"),o=/\s+/,s=Object.prototype.toString;n.exports=function(t){return new r(t)},r.prototype.add=function(t){if(this.list)return this.list.add(t),this;var e=this.array(),n=i(e,t);return~n||e.push(t),this.el.className=e.join(" "),this},r.prototype.remove=function(t){if("[object RegExp]"==s.call(t))return this.removeMatching(t);if(this.list)return this.list.remove(t),this;var e=this.array(),n=i(e,t);return~n&&e.splice(n,1),this.el.className=e.join(" "),this},r.prototype.removeMatching=function(t){for(var e=this.array(),n=0;n<e.length;n++)t.test(e[n])&&this.remove(e[n]);return this},r.prototype.toggle=function(t){return this.list?(this.list.toggle(t),this):(this.has(t)?this.remove(t):this.add(t),this)},r.prototype.array=function(){var t=this.el.className.replace(/^\s+|\s+$/g,""),e=t.split(o);return""===e[0]&&e.shift(),e},r.prototype.has=r.prototype.contains=function(t){return this.list?this.list.contains(t):!!~i(this.array(),t)}}),t.register("css",function(t,e,n){var r={columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0};n.exports=function(t,e){for(var n in e){var i=e[n];"number"!=typeof i||r[n]||(i+="px"),t.style[n]=i}return t}}),t.register("component-sort/index.js",function(t,e,n){function r(t,e){for(var n=[].slice.call(t.children).sort(e),r=document.createDocumentFragment(),i=0;i<n.length;i++)r.appendChild(n[i]);t.appendChild(r)}t=n.exports=r,t.desc=function(t,e){r(t,function(t,n){return~e(t,n)+1})},t.asc=r}),t.register("value",function(t,e,n){function r(t){switch(o(t)){case"checkbox":case"radio":if(t.checked){var e=t.getAttribute("value");return null==e?!0:e}return!1;case"radiogroup":for(var n,r=0;n=t[r];r++)if(n.checked)return n.value;break;case"select":for(var i,s=[],r=0;i=t.options[r];r++)i.selected&&s.push(i.value);return 1===s.length?s[0]:s;default:return t.value}}function i(t,e){switch(o(t)){case"checkbox":case"radio":t.checked=e?!0:!1;break;case"radiogroup":for(var n,r=0;n=t[r];r++)n.checked=n.value===e;break;case"select":for(var i,a,u="array"==s(e)?e:[e],r=0;a=t.options[r];r++){i=0;for(var l,c=0;l=u[c];c++)i|=l===a.value;a.selected=1===i}break;default:t.value=e}}function o(t){var e="array"==s(t)||"object"==s(t);e&&(t=t[0]);var n=t.nodeName.toLowerCase(),r=t.getAttribute("type");return e&&r&&"radio"==r.toLowerCase()?"radiogroup":"input"==n&&r&&"checkbox"==r.toLowerCase()?"checkbox":"input"==n&&r&&"radio"==r.toLowerCase()?"radio":"select"==n?"select":n}var s=e("type");n.exports=function(t,e){return 2==arguments.length?i(t,e):r(t)}}),t.register("query",function(t,e,n){function r(t,e){return e.querySelector(t)}t=n.exports=function(t,e){return e=e||document,r(t,e)},t.all=function(t,e){return e=e||document,e.querySelectorAll(t)},t.engine=function(e){if(!e.one)throw new Error(".one callback required");if(!e.all)throw new Error(".all callback required");return r=e.one,t.all=e.all,t}}),t.register("matches-selector",function(t,e,n){function r(t,e){if(s)return s.call(t,e);for(var n=i.all(e,t.parentNode),r=0;r<n.length;++r)if(n[r]==t)return!0;return!1}var i=e("query"),o=Element.prototype,s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.msMatchesSelector||o.oMatchesSelector;n.exports=r}),t.register("traverse",function(t,e,n){var r=e("matches-selector");n.exports=function(t,e,n,i){var e=e[t],o=i||1,s=[];if(!e)return s;do{if(o==s.length)break;1==e.nodeType&&(r(e,n)&&s.push(e),n||s.push(e))}while(e=e[t]);return s}}),t.register("trim",function(t,e,n){function r(t){return t.trim?t.trim():t.replace(/^\s*|\s*$/g,"")}t=n.exports=r,t.left=function(t){return t.trimLeft?t.trimLeft():t.replace(/^\s*/,"")},t.right=function(t){return t.trimRight?t.trimRight():t.replace(/\s*$/,"")}}),t.register("dom",function(t,e,n){function r(t,e){if(Array.isArray(t))return new i(t);if(t instanceof i)return t;if(t.nodeName)return new i([t]);if("string"!=typeof t)throw new TypeError("invalid selector");var n=d.left(t);if("<"==n.charAt(0))return new i([l(n)],n);var r=e?e.els?e.els[0]:e:document;return new i(f.all(t,r),t)}function i(t,e){this.els=t||[],this.selector=e}var o=e("matches-selector"),s=e("delegate"),a=e("classes"),u=e("traverse");e("indexof");var l=e("domify"),c=e("event"),h=e("value"),f=e("query"),p=e("type"),d=e("trim"),g=e("css"),v=["id","src","rel","cols","rows","type","name","href","title","style","width","height","action","method","tabindex","placeholder"];t=n.exports=r,t.attrs=v,t.List=i,i.prototype.__iterate__=function(){var t=this;return{length:function(){return t.els.length},get:function(e){return new i([t.els[e]])}}},i.prototype.remove=function(){for(var t=0;t<this.els.length;t++){var e=this.els[t],n=e.parentNode;n&&n.removeChild(e)}},i.prototype.attr=function(t,e){if("object"==typeof t){for(var n in t)this.attr(n,t[n]);return this}return 1==arguments.length?this.els[0]&&this.els[0].getAttribute(t):null==e?this.removeAttr(t):this.forEach(function(n){n.setAttribute(t,e)})},i.prototype.removeAttr=function(t){return this.forEach(function(e){e.removeAttribute(t)})},i.prototype.prop=function(t,e){return 1==arguments.length?this.els[0]&&this.els[0][t]:this.forEach(function(n){n[t]=e})},i.prototype.val=i.prototype.value=function(t){return 0==arguments.length?this.els[0]?h(this.els[0]):void 0:this.forEach(function(e){h(e,t)})},i.prototype.clone=function(){for(var t=[],e=0,n=this.els.length;n>e;++e)t.push(this.els[e].cloneNode(!0));return new i(t)},i.prototype.prepend=function(t){var e=this.els[0];if(!e)return this;t=r(t);for(var n=0;n<t.els.length;++n)e.children.length?e.insertBefore(t.els[n],e.firstChild):e.appendChild(t.els[n]);return t},i.prototype.append=function(t){var e=this.els[0];if(!e)return this;t=r(t);for(var n=0;n<t.els.length;++n)e.appendChild(t.els[n]);return t},i.prototype.appendTo=function(t){return r(t).append(this),this},i.prototype.insertAfter=function(t){return t=r(t).els[0],t&&t.parentNode?(this.forEach(function(e){t.parentNode.insertBefore(e,t.nextSibling)}),this):this},i.prototype.at=function(t){return new i([this.els[t]],this.selector)},i.prototype.first=function(){return new i([this.els[0]],this.selector)},i.prototype.last=function(){return new i([this.els[this.els.length-1]],this.selector)},i.prototype.get=function(t){return this.els[t||0]},i.prototype.length=function(){return this.els.length},i.prototype.text=function(t){if(1==arguments.length)return this.forEach(function(e){e.textContent=t}),this;for(var t="",e=0;e<this.els.length;++e)t+=this.els[e].textContent;return t},i.prototype.html=function(t){return 1==arguments.length?this.forEach(function(e){e.innerHTML=t}):this.els[0]&&this.els[0].innerHTML},i.prototype.on=function(t,e,n,r){if("string"==typeof e){for(var i=0;i<this.els.length;++i)n._delegate=s.bind(this.els[i],e,t,n,r);return this}r=n,n=e;for(var i=0;i<this.els.length;++i)c.bind(this.els[i],t,n,r);return this},i.prototype.off=function(t,e,n,r){if("string"==typeof e){for(var i=0;i<this.els.length;++i)s.unbind(this.els[i],t,n._delegate,r);return this}r=n,n=e;for(var i=0;i<this.els.length;++i)c.unbind(this.els[i],t,n,r);return this},i.prototype.each=function(t){for(var e=0;e<this.els.length;++e)t(new i([this.els[e]],this.selector),e);return this},i.prototype.forEach=function(t){for(var e=0;e<this.els.length;++e)t(this.els[e],e);return this},i.prototype.map=function(t){for(var e=[],n=0;n<this.els.length;++n)e.push(t(new i([this.els[n]],this.selector),n));return e},i.prototype.select=i.prototype.filter=function(t){for(var e,n=new i([],this.selector),r=0;r<this.els.length;++r)e=this.els[r],t(new i([e],this.selector),r)&&n.els.push(e);return n},i.prototype.reject=function(t){for(var e,n=new i([],this.selector),r=0;r<this.els.length;++r)e=this.els[r],t(new i([e],this.selector),r)||n.els.push(e);return n},i.prototype.addClass=function(t){for(var e,n=0;n<this.els.length;++n)e=this.els[n],e._classes=e._classes||a(e),e._classes.add(t);return this},i.prototype.removeClass=function(t){var e;if("regexp"==p(t)){for(var n=0;n<this.els.length;++n){e=this.els[n],e._classes=e._classes||a(e);for(var r=e._classes.array(),i=0;i<r.length;i++)t.test(r[i])&&e._classes.remove(r[i])}return this}for(var n=0;n<this.els.length;++n)e=this.els[n],e._classes=e._classes||a(e),e._classes.remove(t);return this},i.prototype.toggleClass=function(t,e){var n,r="toggle";2==arguments.length&&(r=e?"add":"remove");for(var i=0;i<this.els.length;++i)n=this.els[i],n._classes=n._classes||a(n),n._classes[r](t);return this},i.prototype.hasClass=function(t){for(var e,n=0;n<this.els.length;++n)if(e=this.els[n],e._classes=e._classes||a(e),e._classes.has(t))return!0;return!1},i.prototype.css=function(t,e){if(2==arguments.length){var n={};return n[t]=e,this.setStyle(n)}return"object"==p(t)?this.setStyle(t):this.getStyle(t)},i.prototype.setStyle=function(t){for(var e=0;e<this.els.length;++e)g(this.els[e],t);return this},i.prototype.getStyle=function(t){var e=this.els[0];return e?e.style[t]:void 0},i.prototype.find=function(t){return r(t,this)},i.prototype.empty=function(){for(var t,e=0;e<this.els.length;++e)for(t=this.els[e];t.firstChild;)t.removeChild(t.firstChild);return this},i.prototype.is=function(t){return o(this.get(0),t)},i.prototype.parent=function(t,e){return new i(u("parentNode",this.get(0),t,e||1))},i.prototype.next=function(t,e){return new i(u("nextSibling",this.get(0),t,e||1))},i.prototype.prev=i.prototype.previous=function(t,e){return new i(u("previousSibling",this.get(0),t,e||1))},v.forEach(function(t){i.prototype[t]=function(e){return 0==arguments.length?this.attr(t):this.attr(t,e)}})}),t.register("underscore",function(t,e,n){(function(){var e=this,r=e._,i={},o=Array.prototype,s=Object.prototype,a=Function.prototype,u=o.push,l=o.slice,c=o.concat,h=s.toString,f=s.hasOwnProperty,p=o.forEach,d=o.map,g=o.reduce,v=o.reduceRight,m=o.filter,y=o.every,b=o.some,x=o.indexOf,w=o.lastIndexOf,_=Array.isArray,A=Object.keys,k=a.bind,E=function(t){return t instanceof E?t:this instanceof E?(this._wrapped=t,void 0):new E(t)};"undefined"!=typeof t?("undefined"!=typeof n&&n.exports&&(t=n.exports=E),t._=E):e._=E,E.VERSION="1.4.4";var j=E.each=E.forEach=function(t,e,n){if(null!=t)if(p&&t.forEach===p)t.forEach(e,n);else if(t.length===+t.length){for(var r=0,o=t.length;o>r;r++)if(e.call(n,t[r],r,t)===i)return}else for(var s in t)if(E.has(t,s)&&e.call(n,t[s],s,t)===i)return};E.map=E.collect=function(t,e,n){var r=[];return null==t?r:d&&t.map===d?t.map(e,n):(j(t,function(t,i,o){r[r.length]=e.call(n,t,i,o)}),r)};var O="Reduce of empty array with no initial value";E.reduce=E.foldl=E.inject=function(t,e,n,r){var i=arguments.length>2;if(null==t&&(t=[]),g&&t.reduce===g)return r&&(e=E.bind(e,r)),i?t.reduce(e,n):t.reduce(e);if(j(t,function(t,o,s){i?n=e.call(r,n,t,o,s):(n=t,i=!0)}),!i)throw new TypeError(O);return n},E.reduceRight=E.foldr=function(t,e,n,r){var i=arguments.length>2;if(null==t&&(t=[]),v&&t.reduceRight===v)return r&&(e=E.bind(e,r)),i?t.reduceRight(e,n):t.reduceRight(e);var o=t.length;if(o!==+o){var s=E.keys(t);o=s.length}if(j(t,function(a,u,l){u=s?s[--o]:--o,i?n=e.call(r,n,t[u],u,l):(n=t[u],i=!0)}),!i)throw new TypeError(O);return n},E.find=E.detect=function(t,e,n){var r;return T(t,function(t,i,o){return e.call(n,t,i,o)?(r=t,!0):void 0}),r},E.filter=E.select=function(t,e,n){var r=[];return null==t?r:m&&t.filter===m?t.filter(e,n):(j(t,function(t,i,o){e.call(n,t,i,o)&&(r[r.length]=t)}),r)},E.reject=function(t,e,n){return E.filter(t,function(t,r,i){return!e.call(n,t,r,i)},n)},E.every=E.all=function(t,e,n){e||(e=E.identity);var r=!0;return null==t?r:y&&t.every===y?t.every(e,n):(j(t,function(t,o,s){return(r=r&&e.call(n,t,o,s))?void 0:i}),!!r)};var T=E.some=E.any=function(t,e,n){e||(e=E.identity);var r=!1;return null==t?r:b&&t.some===b?t.some(e,n):(j(t,function(t,o,s){return r||(r=e.call(n,t,o,s))?i:void 0}),!!r)};E.contains=E.include=function(t,e){return null==t?!1:x&&t.indexOf===x?-1!=t.indexOf(e):T(t,function(t){return t===e})},E.invoke=function(t,e){var n=l.call(arguments,2),r=E.isFunction(e);return E.map(t,function(t){return(r?e:t[e]).apply(t,n)})},E.pluck=function(t,e){return E.map(t,function(t){return t[e]})},E.where=function(t,e,n){return E.isEmpty(e)?n?null:[]:E[n?"find":"filter"](t,function(t){for(var n in e)if(e[n]!==t[n])return!1;return!0})},E.findWhere=function(t,e){return E.where(t,e,!0)},E.max=function(t,e,n){if(!e&&E.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&E.isEmpty(t))return-1/0;var r={computed:-1/0,value:-1/0};return j(t,function(t,i,o){var s=e?e.call(n,t,i,o):t;s>=r.computed&&(r={value:t,computed:s})}),r.value},E.min=function(t,e,n){if(!e&&E.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&E.isEmpty(t))return 1/0;var r={computed:1/0,value:1/0};return j(t,function(t,i,o){var s=e?e.call(n,t,i,o):t;s<r.computed&&(r={value:t,computed:s})}),r.value},E.shuffle=function(t){var e,n=0,r=[];return j(t,function(t){e=E.random(n++),r[n-1]=r[e],r[e]=t}),r};var S=function(t){return E.isFunction(t)?t:function(e){return e[t]}};E.sortBy=function(t,e,n){var r=S(e);return E.pluck(E.map(t,function(t,e,i){return{value:t,index:e,criteria:r.call(n,t,e,i)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return t.index<e.index?-1:1}),"value")};var C=function(t,e,n,r){var i={},o=S(e||E.identity);return j(t,function(e,s){var a=o.call(n,e,s,t);r(i,a,e)}),i};E.groupBy=function(t,e,n){return C(t,e,n,function(t,e,n){(E.has(t,e)?t[e]:t[e]=[]).push(n)})},E.countBy=function(t,e,n){return C(t,e,n,function(t,e){E.has(t,e)||(t[e]=0),t[e]++})},E.sortedIndex=function(t,e,n,r){n=null==n?E.identity:S(n);for(var i=n.call(r,e),o=0,s=t.length;s>o;){var a=o+s>>>1;n.call(r,t[a])<i?o=a+1:s=a}return o},E.toArray=function(t){return t?E.isArray(t)?l.call(t):t.length===+t.length?E.map(t,E.identity):E.values(t):[]},E.size=function(t){return null==t?0:t.length===+t.length?t.length:E.keys(t).length},E.first=E.head=E.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:l.call(t,0,e)},E.initial=function(t,e,n){return l.call(t,0,t.length-(null==e||n?1:e))},E.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:l.call(t,Math.max(t.length-e,0))},E.rest=E.tail=E.drop=function(t,e,n){return l.call(t,null==e||n?1:e)},E.compact=function(t){return E.filter(t,E.identity)};var N=function(t,e,n){return j(t,function(t){E.isArray(t)?e?u.apply(n,t):N(t,e,n):n.push(t)}),n};E.flatten=function(t,e){return N(t,e,[])},E.without=function(t){return E.difference(t,l.call(arguments,1))},E.uniq=E.unique=function(t,e,n,r){E.isFunction(e)&&(r=n,n=e,e=!1);var i=n?E.map(t,n,r):t,o=[],s=[];return j(i,function(n,r){(e?r&&s[s.length-1]===n:E.contains(s,n))||(s.push(n),o.push(t[r]))}),o},E.union=function(){return E.uniq(c.apply(o,arguments))},E.intersection=function(t){var e=l.call(arguments,1);return E.filter(E.uniq(t),function(t){return E.every(e,function(e){return E.indexOf(e,t)>=0})})},E.difference=function(t){var e=c.apply(o,l.call(arguments,1));return E.filter(t,function(t){return!E.contains(e,t)})},E.zip=function(){for(var t=l.call(arguments),e=E.max(E.pluck(t,"length")),n=new Array(e),r=0;e>r;r++)n[r]=E.pluck(t,""+r);return n},E.object=function(t,e){if(null==t)return{};for(var n={},r=0,i=t.length;i>r;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},E.indexOf=function(t,e,n){if(null==t)return-1;var r=0,i=t.length;if(n){if("number"!=typeof n)return r=E.sortedIndex(t,e),t[r]===e?r:-1;r=0>n?Math.max(0,i+n):n}if(x&&t.indexOf===x)return t.indexOf(e,n);for(;i>r;r++)if(t[r]===e)return r;return-1},E.lastIndexOf=function(t,e,n){if(null==t)return-1;var r=null!=n;if(w&&t.lastIndexOf===w)return r?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var i=r?n:t.length;i--;)if(t[i]===e)return i;return-1},E.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((e-t)/n),0),i=0,o=new Array(r);r>i;)o[i++]=t,t+=n;return o},E.bind=function(t,e){if(t.bind===k&&k)return k.apply(t,l.call(arguments,1));var n=l.call(arguments,2);return function(){return t.apply(e,n.concat(l.call(arguments)))}},E.partial=function(t){var e=l.call(arguments,1);return function(){return t.apply(this,e.concat(l.call(arguments)))}},E.bindAll=function(t){var e=l.call(arguments,1);return 0===e.length&&(e=E.functions(t)),j(e,function(e){t[e]=E.bind(t[e],t)}),t},E.memoize=function(t,e){var n={};return e||(e=E.identity),function(){var r=e.apply(this,arguments);return E.has(n,r)?n[r]:n[r]=t.apply(this,arguments)}},E.delay=function(t,e){var n=l.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},E.defer=function(t){return E.delay.apply(E,[t,1].concat(l.call(arguments,1)))},E.throttle=function(t,e){var n,r,i,o,s=0,a=function(){s=new Date,i=null,o=t.apply(n,r)};return function(){var u=new Date,l=e-(u-s);return n=this,r=arguments,0>=l?(clearTimeout(i),i=null,s=u,o=t.apply(n,r)):i||(i=setTimeout(a,l)),o}},E.debounce=function(t,e,n){var r,i;return function(){var o=this,s=arguments,a=function(){r=null,n||(i=t.apply(o,s))},u=n&&!r;return clearTimeout(r),r=setTimeout(a,e),u&&(i=t.apply(o,s)),i}},E.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},E.wrap=function(t,e){return function(){var n=[t];return u.apply(n,arguments),e.apply(this,n)}},E.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},E.after=function(t,e){return 0>=t?e():function(){return--t<1?e.apply(this,arguments):void 0}},E.keys=A||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)E.has(t,n)&&(e[e.length]=n);return e},E.values=function(t){var e=[];for(var n in t)E.has(t,n)&&e.push(t[n]);return e},E.pairs=function(t){var e=[];for(var n in t)E.has(t,n)&&e.push([n,t[n]]);return e},E.invert=function(t){var e={};for(var n in t)E.has(t,n)&&(e[t[n]]=n);return e},E.functions=E.methods=function(t){var e=[];for(var n in t)E.isFunction(t[n])&&e.push(n);return e.sort()},E.extend=function(t){return j(l.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},E.pick=function(t){var e={},n=c.apply(o,l.call(arguments,1));return j(n,function(n){n in t&&(e[n]=t[n])}),e},E.omit=function(t){var e={},n=c.apply(o,l.call(arguments,1));for(var r in t)E.contains(n,r)||(e[r]=t[r]);return e},E.defaults=function(t){return j(l.call(arguments,1),function(e){if(e)for(var n in e)null==t[n]&&(t[n]=e[n])}),t},E.clone=function(t){return E.isObject(t)?E.isArray(t)?t.slice():E.extend({},t):t},E.tap=function(t,e){return e(t),t};var M=function(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof E&&(t=t._wrapped),e instanceof E&&(e=e._wrapped);var i=h.call(t);if(i!=h.call(e))return!1;switch(i){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var o=n.length;o--;)if(n[o]==t)return r[o]==e;n.push(t),r.push(e);var s=0,a=!0;if("[object Array]"==i){if(s=t.length,a=s==e.length)for(;s--&&(a=M(t[s],e[s],n,r)););}else{var u=t.constructor,l=e.constructor;if(u!==l&&!(E.isFunction(u)&&u instanceof u&&E.isFunction(l)&&l instanceof l))return!1;for(var c in t)if(E.has(t,c)&&(s++,!(a=E.has(e,c)&&M(t[c],e[c],n,r))))break;if(a){for(c in e)if(E.has(e,c)&&!s--)break;a=!s}}return n.pop(),r.pop(),a};E.isEqual=function(t,e){return M(t,e,[],[])},E.isEmpty=function(t){if(null==t)return!0;if(E.isArray(t)||E.isString(t))return 0===t.length;for(var e in t)if(E.has(t,e))return!1;return!0},E.isElement=function(t){return!(!t||1!==t.nodeType)},E.isArray=_||function(t){return"[object Array]"==h.call(t)},E.isObject=function(t){return t===Object(t)},j(["Arguments","Function","String","Number","Date","RegExp"],function(t){E["is"+t]=function(e){return h.call(e)=="[object "+t+"]"}}),E.isArguments(arguments)||(E.isArguments=function(t){return!(!t||!E.has(t,"callee"))}),"function"!=typeof/./&&(E.isFunction=function(t){return"function"==typeof t}),E.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},E.isNaN=function(t){return E.isNumber(t)&&t!=+t},E.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==h.call(t)},E.isNull=function(t){return null===t},E.isUndefined=function(t){return void 0===t},E.has=function(t,e){return f.call(t,e)},E.noConflict=function(){return e._=r,this},E.identity=function(t){return t},E.times=function(t,e,n){for(var r=Array(t),i=0;t>i;i++)r[i]=e.call(n,i);return r},E.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};I.unescape=E.invert(I.escape);var L={escape:new RegExp("["+E.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+E.keys(I.unescape).join("|")+")","g")};E.each(["escape","unescape"],function(t){E[t]=function(e){return null==e?"":(""+e).replace(L[t],function(e){return I[t][e]})}}),E.result=function(t,e){if(null==t)return null;var n=t[e];return E.isFunction(n)?n.call(t):n},E.mixin=function(t){j(E.functions(t),function(e){var n=E[e]=t[e];E.prototype[e]=function(){var t=[this._wrapped];return u.apply(t,arguments),q.call(this,n.apply(E,t))}})};var F=0;E.uniqueId=function(t){var e=++F+"";return t?t+e:e},E.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var R=/(.)^/,H={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\t|\u2028|\u2029/g;E.template=function(t,e,n){var r;n=E.defaults({},n,E.templateSettings);var i=new RegExp([(n.escape||R).source,(n.interpolate||R).source,(n.evaluate||R).source].join("|")+"|$","g"),o=0,s="__p+='";t.replace(i,function(e,n,r,i,a){return s+=t.slice(o,a).replace(D,function(t){return"\\"+H[t]}),n&&(s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(s+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(s+="';\n"+i+"\n__p+='"),o=a+e.length,e}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{r=new Function(n.variable||"obj","_",s)}catch(a){throw a.source=s,a}if(e)return r(e,E);var u=function(t){return r.call(this,t,E)};return u.source="function("+(n.variable||"obj")+"){\n"+s+"}",u},E.chain=function(t){return E(t).chain()};var q=function(t){return this._chain?E(t).chain():t};E.mixin(E),j(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=o[t];E.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],q.call(this,n)}}),j(["concat","join","slice"],function(t){var e=o[t];E.prototype[t]=function(){return q.call(this,e.apply(this._wrapped,arguments))}}),E.extend(E.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this)}),t.register("backbone-events",function(t,e,n){var r=[];r.push;var i=r.slice;r.splice;var o=e("underscore"),s=n.exports.Events={on:function(t,e,n){if(!u(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var r=this._events[t]||(this._events[t]=[]);return r.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,n){if(!u(this,"once",t,[e,n])||!e)return this;var r=this,i=o.once(function(){r.off(t,i),e.apply(this,arguments)});return i._callback=e,this.on(t,i,n)},off:function(t,e,n){var r,i,s,a,l,c,h,f;if(!this._events||!u(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events={},this;for(a=t?[t]:o.keys(this._events),l=0,c=a.length;c>l;l++)if(t=a[l],s=this._events[t]){if(this._events[t]=r=[],e||n)for(h=0,f=s.length;f>h;h++)i=s[h],(e&&e!==i.callback&&e!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=i.call(arguments,1);if(!u(this,"trigger",t,e))return this;var n=this._events[t],r=this._events.all;return n&&l(n,e),r&&l(r,arguments),this},stopListening:function(t,e,n){var r=this._listeningTo;if(!r)return this;var i=!e&&!n;n||"object"!=typeof e||(n=this),t&&((r={})[t._listenId]=t);for(var s in r)t=r[s],t.off(e,n,this),(i||o.isEmpty(t._events))&&delete this._listeningTo[s];return this}},a=/\s+/,u=function(t,e,n,r){if(!n)return!0;if("object"==typeof n){for(var i in n)t[e].apply(t,[i,n[i]].concat(r));return!1}if(a.test(n)){for(var o=n.split(a),s=0,u=o.length;u>s;s++)t[e].apply(t,[o[s]].concat(r));return!1}return!0},l=function(t,e){var n,r=-1,i=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++r<i;)(n=t[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o);return;case 2:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o,s);return;case 3:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o,s,a);return;default:for(;++r<i;)(n=t[r]).callback.apply(n.ctx,e)}},c={listenTo:"on",listenToOnce:"once"};o.each(c,function(t,e){s[e]=function(e,n,r){var i=this._listeningTo||(this._listeningTo={}),s=e._listenId||(e._listenId=o.uniqueId("l"));return i[s]=e,r||"object"!=typeof n||(r=this),e[t](n,r,this),this}}),s.bind=s.on,s.unbind=s.off}),t.register("hyperbone-view",function(t,e,n){function r(t){u(t.node)?t.node.setAttribute(t.attribute,t.fn(this.model,y)):t.node.replaceWholeText(t.fn(this.model,y))}function i(t,e){var n=e(t);if(n)for(t=t.firstChild;t;)i(t,e),t=t.nextSibling}function o(t){var e=[];return p.each(t,function(t,n){1===n%2&&e.push(t.trim())}),e}function s(t){for(var t,e,n,r=[],i=0;i<t.length;++i)e=t[i],0==i%2?r.push('"'+e.replace(/"/g,'\\"')+'"'):c(e)?r.push(' + model.get("'+e+'") + '):(n=h(e))?r.push(' + helpers["'+n.fn+'"]( model.get("'+n.val+'"), model) + '):(n=f(e))&&r.push(' + helpers["'+n.fn+'"]('+(n.val?n.val:'""')+", model) + ");return r="\n return "+r.join("").replace(/\n/g,"\\n"),new Function("model","helpers",r)}function a(t){return t.split(g.tache)}function u(t){return 1===t.nodeType}function l(t){return 3===t.nodeType}function c(t){return g.alias.test(t)}function h(t){var e=t.match(g.helper);return e?{fn:e[1],val:e[2]}:!1}function f(t){var e=t.match(g.expression);return e?{fn:e[1],val:e[2]}:!1}var p=e("underscore"),d=e("dom"),g={alias:/^[A-Za-z0-9\_\.]+$/,helper:/^([A-Za-z\_\.]+)\(([A-Za-z0-9\_\.]+)\)$/,expression:/^([A-Za-z\_\.]+)\((|(.+))\)$/,tache:/\{\{|\}\}/},v=e("backbone-events").Events,m={},y={},b=function(t){return this.activeNodes=[],this.delegates=[],p.extend(this,v),t&&(t.initialised&&this.on("initialised",t.initialised),t.delegates&&this.addDelegate(t.delegates),t.model&&t.el&&this.create(t.el,t.model)),this};b.prototype={create:function(t,e){return this.el=d(t),this._original=this.el.clone(),this.model=e,this.evaluate(),this.bindToModel(),this.activateDelegates(),this.trigger("initialised",this.el,this.model),u(this.el.els[0])&&this.el.css({display:"block"}),this},addDelegate:function(t,e){return p.isObject(t)?(p.each(t,function(t,e){this.addDelegate(e,t)},this),this):(this.delegates.push({selector:t,fn:e}),this)},evaluate:function(){var t=this;return i(this.el.els[0],function(e){var n,r=!0;return u(e)?(p.each(e.attributes,function(n){m[n.name]&&m[n.name].call(t,e,e.getAttribute(n.name),function(){r=!1});var i=a(n.nodeValue);i.length>1&&t.activeNodes.push({node:e,attribute:n.name,original:n.nodeValue,expressions:o(i),tokens:i})}),r):l(e)?(n=a(e.wholeText),n.length>1&&t.activeNodes.push({node:e,expressions:o(n),original:e.wholeText,tokens:n}),!0):!0}),this},bindToModel:function(){var t=this;return p.each(this.activeNodes,function(e){e.fn=s(e.tokens),p.each(e.expressions,function(n){var n,i="change";c(n)?i="change:"+n:(n=h(n))&&(i="change:"+n.val),this.model.on(i,function(){r.call(t,e),t.trigger("updated",t.el,t.model,i)})},this),r.call(t,e)},this),this},activateDelegates:function(){var t=this;return p.each(this.delegates,function(e){var n=e.selector.split(" "),r=n[0],i=n[1];this.el.on(r,i,function(n){e.fn.call(t.model,n,t.model,t.el),t.trigger("delegate-fired",t.el,t.model,e.selector)})},this),this}},n.exports.HyperboneView=b,p.extend(y,{get:function(t){return t},url:function(t,e){return e.url()},rel:function(t,e){return e.rel(t)},expression:function(t){return t}});var x;n.exports.registerHelper=x=function(t,e){p.isObject(t)?p.extend(y,t):y[t]=e},p.extend(m,{rel:function(t){"A"===t.tagName&&(rel=t.getAttribute("rel"),rel&&1===a(rel).length&&t.setAttribute("href",this.model.rel(rel)))},"if":function(t,e){var n=this,r=function(){d(t).css({display:n.model.get(e)?"":"none"})};this.model.on("change:"+e,function(){r()}),r()},"hb-with":function(t,e,n){var r,i,o=this;if(t.removeAttribute("hb-with"),r=this.model.get(e),r.models){i=document.createDocumentFragment(),p.each(t.children,function(t){i.appendChild(t)}),r.__hyperbone_view=t,r.__hyperbone_subview=i;var s=function(n){n.each(function(n){var r=i.cloneNode(!0);(new b).on("updated",function(t,n,r){o.trigger("updated",t,n,"subview "+e+" "+r)}).create(d(r),n),t.appendChild(r)})};r.on("add remove",function(){t.innerHTML="",s(o.model.get(e))}),s(r)}else(new b).on("updated",function(t,n,r){o.trigger("updated",t,n,"subview "+e+" "+r)}).create(d(t),o.model.get(e));n()},"hb-bind":function(t,e,n){var r=this,i=d(t),o=this.model.get(e);
i.on("change",function(){var t=r.model.get(e),n=i.val();t!==n&&r.model.set(e,n)}),this.model.on("change:"+e,function(t,e){var n=i.val();n!==e&&i.val(e)}),i.val(o),n()},"hb-click-bind":function(t,e){var n=this;n.model.set(e,!1),d(t).on("click",function(){n.model.set(e,!0)})},"hb-trigger":function(t,e){var n=this;n.model.set(e,!1),d(t).on("click",function(r){n.model.trigger(e,n.model,t,r)})}});var w;n.exports.registerAttributeHandler=w=function(t,e){p.isObject(t)?p.extend(m,t):m[t]=e},n.exports.use=function(t){t.attributeHandlers&&p.each(t.attributeHandlers,function(t,e){w(e,t)}),t.templateHelpers&&p.each(t.templateHelpers,function(t,e){x(e,t)})}}),t.register("backbone-helpers",function(t,e,n){var r=e("underscore");n.exports.extend=function(t,e){var n,i=this;n=t&&r.has(t,"constructor")?t.constructor:function(){return i.apply(this,arguments)},r.extend(n,i,e);var o=function(){this.constructor=n};return o.prototype=i.prototype,n.prototype=new o,t&&r.extend(n.prototype,t),n.__super__=i.prototype,n},n.exports.urlError=function(){throw new Error('A "url" property or function must be specified')},n.exports.wrapError=function(t,e){var n=e.error;e.error=function(r){n&&n(t,r,e),t.trigger("error",t,r,e)}}}),t.register("backbone-model",function(t,e,n){var r=e("underscore"),i=e("backbone-events").Events,o=e("backbone-helpers").urlError,s=e("backbone-helpers").wrapError,a=[];a.push;var u=a.slice;a.splice;var l=n.exports.Model=function(t,e){var n=t||{};e||(e={}),this.cid=r.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{}),n=r.defaults({},n,r.result(this,"defaults")),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};r.extend(l.prototype,i,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return r.clone(this.attributes)},sync:function(){throw new Error("Sync component not used")},get:function(t){return this.attributes[t]},escape:function(t){return r.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var i,o,s,a,u,l,c,h;if(null==t)return this;if("object"==typeof t?(o=t,n=e):(o={})[t]=e,n||(n={}),!this._validate(o,n))return!1;s=n.unset,u=n.silent,a=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=r.clone(this.attributes),this.changed={}),h=this.attributes,c=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(i in o)e=o[i],r.isEqual(h[i],e)||a.push(i),r.isEqual(c[i],e)?delete this.changed[i]:this.changed[i]=e,s?delete h[i]:h[i]=e;if(!u){a.length&&(this._pending=!0);for(var f=0,p=a.length;p>f;f++)this.trigger("change:"+a[f],this,h[a[f]],n)}if(l)return this;if(!u)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,r.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,r.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!r.isEmpty(this.changed):r.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?r.clone(this.changed):!1;var e,n=!1,i=this._changing?this._previousAttributes:this.attributes;for(var o in t)r.isEqual(i[o],e=t[o])||((n||(n={}))[o]=e);return n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return r.clone(this._previousAttributes)},fetch:function(t){t=t?r.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,n=t.success;return t.success=function(r){return e.set(e.parse(r,t),t)?(n&&n(e,r,t),e.trigger("sync",e,r,t),void 0):!1},s(this,t),this.sync("read",this,t)},save:function(t,e,n){var i,o,a,u=this.attributes;if(null==t||"object"==typeof t?(i=t,n=e):(i={})[t]=e,n=r.extend({validate:!0},n),i&&!n.wait){if(!this.set(i,n))return!1}else if(!this._validate(i,n))return!1;i&&n.wait&&(this.attributes=r.extend({},u,i)),void 0===n.parse&&(n.parse=!0);var l=this,c=n.success;return n.success=function(t){l.attributes=u;var e=l.parse(t,n);return n.wait&&(e=r.extend(i||{},e)),r.isObject(e)&&!l.set(e,n)?!1:(c&&c(l,t,n),l.trigger("sync",l,t,n),void 0)},s(this,n),o=this.isNew()?"create":n.patch?"patch":"update","patch"===o&&(n.attrs=i),a=this.sync(o,this,n),i&&n.wait&&(this.attributes=u),a},destroy:function(t){t=t?r.clone(t):{};var e=this,n=t.success,i=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(r){(t.wait||e.isNew())&&i(),n&&n(e,r,t),e.isNew()||e.trigger("sync",e,r,t)},this.isNew())return t.success(),!1;s(this,t);var o=this.sync("delete",this,t);return t.wait||i(),o},url:function(){var t=r.result(this,"urlRoot")||r.result(this.collection,"url")||o();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},r.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=r.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return n?(this.trigger("invalid",this,n,r.extend(e,{validationError:n})),!1):!0}});var c=["keys","values","pairs","invert","pick","omit"];r.each(c,function(t){l.prototype[t]=function(){var e=u.call(arguments);return e.unshift(this.attributes),r[t].apply(r,e)}}),l.extend=e("backbone-helpers").extend}),t.register("backbone-collection",function(t,e,n){var r=e("underscore"),i=e("backbone-model").Model,o=e("backbone-events").Events,s=[];s.push;var a=s.slice;s.splice;var u=e("backbone-helpers").wrapError,l=n.exports.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,r.extend({silent:!0},e))},c={add:!0,remove:!0,merge:!0},h={add:!0,remove:!1};r.extend(l.prototype,o,{model:i,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(t,e){return this.set(t,r.extend({merge:!1},e,h))},remove:function(t,e){var n=!r.isArray(t);t=n?[t]:r.clone(t),e||(e={});var i,o,s,a;for(i=0,o=t.length;o>i;i++)a=t[i]=this.get(t[i]),a&&(delete this._byId[a.id],delete this._byId[a.cid],s=this.indexOf(a),this.models.splice(s,1),this.length--,e.silent||(e.index=s,a.trigger("remove",a,this,e)),this._removeReference(a));return n?t[0]:t},set:function(t,e){e=r.defaults({},e,c),e.parse&&(t=this.parse(t,e));var n=!r.isArray(t);t=n?t?[t]:[]:r.clone(t);var o,s,a,u,l,h,f,p=e.at,d=this.model,g=this.comparator&&null==p&&e.sort!==!1,v=r.isString(this.comparator)?this.comparator:null,m=[],y=[],b={},x=e.add,w=e.merge,_=e.remove,A=!g&&x&&_?[]:!1;for(o=0,s=t.length;s>o;o++){if(l=t[o],a=l instanceof i?u=l:l[d.prototype.idAttribute],h=this.get(a))_&&(b[h.cid]=!0),w&&(l=l===u?u.attributes:l,e.parse&&(l=h.parse(l,e)),h.set(l,e),g&&!f&&h.hasChanged(v)&&(f=!0)),t[o]=h;else if(x){if(u=t[o]=this._prepareModel(l,e),!u)continue;m.push(u),u.on("all",this._onModelEvent,this),this._byId[u.cid]=u,null!=u.id&&(this._byId[u.id]=u)}A&&A.push(h||u)}if(_){for(o=0,s=this.length;s>o;++o)b[(u=this.models[o]).cid]||y.push(u);y.length&&this.remove(y,e)}if(m.length||A&&A.length)if(g&&(f=!0),this.length+=m.length,null!=p)for(o=0,s=m.length;s>o;o++)this.models.splice(p+o,0,m[o]);else{A&&(this.models.length=0);var k=A||m;for(o=0,s=k.length;s>o;o++)this.models.push(k[o])}if(f&&this.sort({silent:!0}),!e.silent){for(o=0,s=m.length;s>o;o++)(u=m[o]).trigger("add",u,this,e);(f||A&&A.length)&&this.trigger("sort",this,e)}return n?t[0]:t},reset:function(t,e){e||(e={});for(var n=0,i=this.models.length;i>n;n++)this._removeReference(this.models[n]);return e.previousModels=this.models,this._reset(),t=this.add(t,r.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,r.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,r.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return a.apply(this.models,arguments)},get:function(t){return null==t?void 0:this._byId[t.id]||this._byId[t.cid]||this._byId[t]},at:function(t){return this.models[t]},where:function(t,e){return r.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),r.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(r.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return r.invoke(this.models,"get",t)},fetch:function(t){t=t?r.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,n=this;return t.success=function(r){var i=t.reset?"reset":"set";n[i](r,t),e&&e(n,r,t),n.trigger("sync",n,r,t)},u(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?r.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var n=this,i=e.success;return e.success=function(t,e,r){r.wait&&n.add(t,r),i&&i(t,e,r)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof i)return t.collection||(t.collection=this),t;e=e?r.clone(e):{},e.collection=this;var n=new this.model(t,e);return n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,r){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,r),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var f=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];r.each(f,function(t){l.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.models),r[t].apply(r,e)}});var p=["groupBy","countBy","sortBy"];r.each(p,function(t){l.prototype[t]=function(e,n){var i=r.isFunction(e)?e:function(t){return t.get(e)};return r[t](this.models,i,n)}}),l.extend=e("backbone-helpers").extend}),t.register("uritemplate",function(t,e,n){!function(t){"use strict";function e(t){var n;if(null===t||void 0===t)return!1;if(r.isArray(t))return t.length>0;if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return!0;for(n in t)if(t.hasOwnProperty(n)&&e(t[n]))return!0;return!1}var n=function(){function t(t){this.options=t}return t.prototype.toString=function(){return JSON&&JSON.stringify?JSON.stringify(this.options):this.options},t}(),r=function(){function t(t){return"[object Array]"===Object.prototype.toString.apply(t)}function e(t){return"[object String]"===Object.prototype.toString.apply(t)}function n(t){return"[object Number]"===Object.prototype.toString.apply(t)}function r(t){return"[object Boolean]"===Object.prototype.toString.apply(t)}function i(t,e){var n,r="",i=!0;for(n=0;n<t.length;n+=1)i?i=!1:r+=e,r+=t[n];return r}function o(t,e){for(var n=[],r=0;r<t.length;r+=1)n.push(e(t[r]));return n}function s(t,e){for(var n=[],r=0;r<t.length;r+=1)e(t[r])&&n.push(t[r]);return n}function a(t){if("object"!=typeof t||null===t)return t;Object.freeze(t);var e,n;for(n in t)t.hasOwnProperty(n)&&(e=t[n],"object"==typeof e&&u(e));return t}function u(t){return"function"==typeof Object.freeze?a(t):t}return{isArray:t,isString:e,isNumber:n,isBoolean:r,join:i,map:o,filter:s,deepFreeze:u}}(),i=function(){function t(t){return t>="a"&&"z">=t||t>="A"&&"Z">=t}function e(t){return t>="0"&&"9">=t}function n(t){return e(t)||t>="a"&&"f">=t||t>="A"&&"F">=t}return{isAlpha:t,isDigit:e,isHexDigit:n}}(),o=function(){function t(t){var e,n,r="",i=s.encode(t);for(n=0;n<i.length;n+=1)e=i.charCodeAt(n),r+="%"+(16>e?"0":"")+e.toString(16).toUpperCase();return r}function e(t,e){return"%"===t.charAt(e)&&i.isHexDigit(t.charAt(e+1))&&i.isHexDigit(t.charAt(e+2))}function n(t,e){return parseInt(t.substr(e,2),16)}function r(t){if(!e(t,0))return!1;var r=n(t,1),i=s.numBytes(r);if(0===i)return!1;for(var o=1;i>o;o+=1)if(!e(t,3*o)||!s.isValidFollowingCharCode(n(t,3*o+1)))return!1;return!0}function o(t,r){var i=t.charAt(r);if(!e(t,r))return i;var o=n(t,r+1),a=s.numBytes(o);if(0===a)return i;for(var u=1;a>u;u+=1)if(!e(t,r+3*u)||!s.isValidFollowingCharCode(n(t,r+3*u+1)))return i;return t.substr(r,3*a)}var s={encode:function(t){return unescape(encodeURIComponent(t))},numBytes:function(t){return 127>=t?1:t>=194&&223>=t?2:t>=224&&239>=t?3:t>=240&&244>=t?4:0},isValidFollowingCharCode:function(t){return t>=128&&191>=t}};return{encodeCharacter:t,isPctEncoded:r,pctCharAt:o}}(),s=function(){function t(t){return i.isAlpha(t)||i.isDigit(t)||"_"===t||o.isPctEncoded(t)}function e(t){return i.isAlpha(t)||i.isDigit(t)||"-"===t||"."===t||"_"===t||"~"===t}function n(t){return":"===t||"/"===t||"?"===t||"#"===t||"["===t||"]"===t||"@"===t||"!"===t||"$"===t||"&"===t||"("===t||")"===t||"*"===t||"+"===t||","===t||";"===t||"="===t||"'"===t}return{isVarchar:t,isUnreserved:e,isReserved:n}}(),a=function(){function t(t,e){var n,r="",i="";for(("number"==typeof t||"boolean"==typeof t)&&(t=t.toString()),n=0;n<t.length;n+=i.length)i=t.charAt(n),r+=s.isUnreserved(i)||e&&s.isReserved(i)?i:o.encodeCharacter(i);return r}function e(e){return t(e,!0)}function n(t,e){var n=o.pctCharAt(t,e);return n.length>1?n:s.isReserved(n)||s.isUnreserved(n)?n:o.encodeCharacter(n)}function r(t){var e,n="",r="";for(e=0;e<t.length;e+=r.length)r=o.pctCharAt(t,e),n+=r.length>1?r:s.isReserved(r)||s.isUnreserved(r)?r:o.encodeCharacter(r);return n}return{encode:t,encodePassReserved:e,encodeLiteral:r,encodeLiteralCharacter:n}}(),u=function(){function t(t){e[t]={symbol:t,separator:"?"===t?"&":""===t||"+"===t||"#"===t?",":t,named:";"===t||"&"===t||"?"===t,ifEmpty:"&"===t||"?"===t?"=":"",first:"+"===t?"":t,encode:"+"===t||"#"===t?a.encodePassReserved:a.encode,toString:function(){return this.symbol}}}var e={};return t(""),t("+"),t("#"),t("."),t("/"),t(";"),t("?"),t("&"),{valueOf:function(t){return e[t]?e[t]:"=,!@|".indexOf(t)>=0?null:e[""]}}}(),l=function(){function t(t){this.literal=a.encodeLiteral(t)}return t.prototype.expand=function(){return this.literal},t.prototype.toString=t.prototype.expand,t}(),c=function(){function t(t){function e(){var e=t.substring(p,l);if(0===e.length)throw new n({expressionText:t,message:"a varname must be specified",position:l});f={varname:e,exploded:!1,maxLength:null},p=null}function r(){if(d===l)throw new n({expressionText:t,message:"after a ':' you have to specify the length",position:l});f.maxLength=parseInt(t.substring(d,l),10),d=null}var a,l,c=[],f=null,p=null,d=null,g="";for(a=function(e){var r=u.valueOf(e);if(null===r)throw new n({expressionText:t,message:"illegal use of reserved operator",position:l,operator:e});return r}(t.charAt(0)),l=a.symbol.length,p=l;l<t.length;l+=g.length){if(g=o.pctCharAt(t,l),null!==p){if("."===g){if(p===l)throw new n({expressionText:t,message:"a varname MUST NOT start with a dot",position:l});continue}if(s.isVarchar(g))continue;e()}if(null!==d){if(l===d&&"0"===g)throw new n({expressionText:t,message:"A :prefix must not start with digit 0",position:l});if(i.isDigit(g)){if(l-d>=4)throw new n({expressionText:t,message:"A :prefix must have max 4 digits",position:l});continue}r()}if(":"!==g)if("*"!==g){if(","!==g)throw new n({expressionText:t,message:"illegal character",character:g,position:l});c.push(f),f=null,p=l+1}else{if(null===f)throw new n({expressionText:t,message:"exploded without varspec",position:l});if(f.exploded)throw new n({expressionText:t,message:"exploded twice",position:l});if(f.maxLength)throw new n({expressionText:t,message:"an explode (*) MUST NOT follow to a prefix",position:l});f.exploded=!0}else{if(null!==f.maxLength)throw new n({expressionText:t,message:"only one :maxLength is allowed per varspec",position:l});if(f.exploded)throw new n({expressionText:t,message:"an exploeded varspec MUST NOT be varspeced",position:l});d=l+1}}return null!==p&&e(),null!==d&&r(),c.push(f),new h(t,a,c)}function e(e){var r,i,o=[],s=null,a=0;for(r=0;r<e.length;r+=1)if(i=e.charAt(r),null===a){if(null===s)throw new Error("reached unreachable code");if("{"===i)throw new n({templateText:e,message:"brace already opened",position:r});if("}"===i){if(s+1===r)throw new n({templateText:e,message:"empty braces",position:s});try{o.push(t(e.substring(s+1,r)))}catch(u){if(u.prototype===n.prototype)throw new n({templateText:e,message:u.options.message,position:s+u.options.position,details:u.options});throw u}s=null,a=r+1}}else{if("}"===i)throw new n({templateText:e,message:"unopened brace closed",position:r});"{"===i&&(r>a&&o.push(new l(e.substring(a,r))),a=null,s=r)}if(null!==s)throw new n({templateText:e,message:"unclosed brace",position:s});return a<e.length&&o.push(new l(e.substr(a))),new f(e,o)}return e}(),h=function(){function t(t){return JSON&&JSON.stringify?JSON.stringify(t):t}function n(t){if(!e(t))return!0;if(r.isString(t))return""===t;if(r.isNumber(t)||r.isBoolean(t))return!1;if(r.isArray(t))return 0===t.length;for(var n in t)if(t.hasOwnProperty(n))return!1;return!0}function i(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push({name:e,value:t[e]});return n}function o(t,e,n){this.templateText=t,this.operator=e,this.varspecs=n}function s(t,e,n){var r="";if(n=n.toString(),e.named){if(r+=a.encodeLiteral(t.varname),""===n)return r+=e.ifEmpty;r+="="}return null!==t.maxLength&&(n=n.substr(0,t.maxLength)),r+=e.encode(n)}function u(t){return e(t.value)}function l(t,o,s){var l=[],c="";if(o.named){if(c+=a.encodeLiteral(t.varname),n(s))return c+=o.ifEmpty;c+="="}return r.isArray(s)?(l=s,l=r.filter(l,e),l=r.map(l,o.encode),c+=r.join(l,",")):(l=i(s),l=r.filter(l,u),l=r.map(l,function(t){return o.encode(t.name)+","+o.encode(t.value)}),c+=r.join(l,",")),c}function c(t,o,s){var l=r.isArray(s),c=[];return l?(c=s,c=r.filter(c,e),c=r.map(c,function(e){var r=a.encodeLiteral(t.varname);return r+=n(e)?o.ifEmpty:"="+o.encode(e)})):(c=i(s),c=r.filter(c,u),c=r.map(c,function(t){var e=a.encodeLiteral(t.name);return e+=n(t.value)?o.ifEmpty:"="+o.encode(t.value)})),r.join(c,o.separator)}function h(t,n){var o=[],s="";return r.isArray(n)?(o=n,o=r.filter(o,e),o=r.map(o,t.encode),s+=r.join(o,t.separator)):(o=i(n),o=r.filter(o,function(t){return e(t.value)}),o=r.map(o,function(e){return t.encode(e.name)+"="+t.encode(e.value)}),s+=r.join(o,t.separator)),s}return o.prototype.toString=function(){return this.templateText},o.prototype.expand=function(i){var o,a,u,f,p=[],d=!1,g=this.operator;for(o=0;o<this.varspecs.length;o+=1)if(a=this.varspecs[o],u=i[a.varname],null!==u&&void 0!==u)if(a.exploded&&(d=!0),f=r.isArray(u),"string"==typeof u||"number"==typeof u||"boolean"==typeof u)p.push(s(a,g,u));else{if(a.maxLength&&e(u))throw new Error("Prefix modifiers are not applicable to variables that have composite values. You tried to expand "+this+" with "+t(u));a.exploded?e(u)&&(g.named?p.push(c(a,g,u)):p.push(h(g,u))):(g.named||!n(u))&&p.push(l(a,g,u))}return 0===p.length?"":g.first+r.join(p,g.separator)},o}(),f=function(){function t(t,e){this.templateText=t,this.expressions=e,r.deepFreeze(this)}return t.prototype.toString=function(){return this.templateText},t.prototype.expand=function(t){var e,n="";for(e=0;e<this.expressions.length;e+=1)n+=this.expressions[e].expand(t);return n},t.parse=c,t.UriTemplateError=n,t}();t(f)}(function(t){"use strict";"undefined"!=typeof n?n.exports=t:"function"==typeof define?define([],function(){return t}):"undefined"!=typeof window?window.UriTemplate=t:global.UriTemplate=t})}),t.register("hyperbone-model",function(t,e,n){var r=e("underscore"),i=e("backbone-model").Model,o=e("backbone-collection").Collection.extend({isHyperbone:!0,toJSON:function(){var t=[];return r.each(this.models,function(e){e.isHyperbone?t.push(e.toJSON()):t.push(e)}),t}}),s=e("uritemplate").parse,a=function(t,e){t||(t={}),this.attributes={},this.cid=r.uniqueId("c"),this.isHyperbone=!0,this._prototypes||(this._prototypes={}),e||(e={}),t._prototypes&&(r.extend(this._prototypes,t._prototypes),delete t._prototypes),e&&e.collection&&(this.collection=e.collection),t=e&&e.parse?this.parse(this.parseHypermedia(t)):this.parseHypermedia(t),t=r.defaults({},t,r.result(this,"defaults")),this.set(t,{silent:!0}),this.changed={},this.initialize.apply(this,arguments)};r.extend(a.prototype,i.prototype,{parseHypermedia:function(t){var e=this;this._links=t._links||{},delete t._links,this._curies={};var n=this._links?this._links.curie?[this._links.curie]:this._links.curies?this._links.curies:null:null;if(n&&r.each(n,function(t){if(!t.templated)throw new Error("A curie without a template? What are you thinking?");this._curies[t.name]=s(t.href)},this),r.each(this._links,function(t,e){r.isArray(t)&&1===t.length&&(this._links[e]=t[0]),t.templated&&(t.template=s(t.href))},this),t._embedded&&(r.each(t._embedded,function(e,n){t[n]=e}),delete t._embedded),t._controls){this._controls={};var i;i=function(t){var n={};return r.each(t,function(t,r){t.method?(n[r]=new a(t),t.action||n[r].set("action",e.url(),{silent:!0})):n[r]=i(t)}),n},this._controls=new a(i(t._controls)),delete t._controls}return t},toJSON:function(){var t={};return r.each(this.attributes,function(e,n){t[n]=e.isHyperbone?e.toJSON():e},this),t},url:function(){if(this._links.self&&this._links.self.href)return this._links.self.href;throw new Error("Not a hypermedia resource")},get:function(t){if(this.attributes[t]||0===this.attributes[t])return this.attributes[t];if(-1!==r.indexOf(t,".")||/([a-zA-Z_]+)\[([0-9]+)\]/.test(t)){var e=t.split(".");t=e.shift();var n=e.join(".");if(this.attributes[t])return this.attributes[t].get(n);e=t.match(/([a-zA-Z_]+)\[([0-9]+)\]/);var i=parseInt(e[2],10);if(t=e[1],r.isNumber(i)&&this.attributes[t])return n?this.attributes[t].at(i).get(n):this.attributes[t].at(i)}return null},set:function(t,e,n){var i,s,u,l,c,h,f,p,d,g,v=this;if(null==t)return this;if("object"==typeof t?(s=t,n=e):(s={})[t]=e,n||(n={}),!this._validate(s,n))return!1;u=n.unset,c=n.silent,l=[],h=this._changing,noTraverse=n.noTraverse||!1,ignoreDotNotation=n.ignoreDotNotation||!1,this._changing=!0,h||(this._previousAttributes=r.clone(this.attributes),this.changed={}),p=this.attributes,f=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]),r.each(s,function(t,e){r.isObject(t)&&p[e]&&p[e].isHyperbone&&(r.isArray(t)?(r.each(t,function(t,n){p[e].at(n).set(t)}),delete s[e]):(p[e].set(t),delete s[e]))});for(i in s){if(-1===r.indexOf(i,".")||ignoreDotNotation){if(e=s[i],r.isObject(e)&&!r.isArray(e))e.isHyperbone||noTraverse||(d=this._prototypes[i]?this._prototypes[i]:a,e=new d(e),e._parent=v),e.on&&(e._trigger=e.trigger,e.trigger=function(t){return function(){var e=Array.prototype.slice.call(arguments,0);this._trigger.apply(this,e),e[0]=e[0]+":"+t,v.trigger.apply(v,e)}}(i));else if(r.isArray(e)){var m=!0;if(r.each(e,function(t){r.isObject(t)||(m=!1)}),m){var y=[];d=this._prototypes[i]?this._prototypes[i]:a;var b=o.extend({model:d}),x=new b;x._parent=v,r.each(e,function(t){y.push(t)},this),x.add(y),x._trigger=x.trigger,x.trigger=function(t){return function(){var e=Array.prototype.slice.call(arguments,0);this._trigger.apply(this,e),e[0]=e[0]+":"+t,v.trigger.apply(v,e)}}(i),e=x}}}else{g=i.split("."),i=g.pop();var w=g.join(".");this.get(w).set(i,e)}r.isEqual(p[i],e)||l.push(i),r.isEqual(f[i],e)?delete this.changed[i]:this.changed[i]=e,u?delete p[i]:p[i]=e}if(!c){l.length&&(this._pending=!0);for(var _=0,A=l.length;A>_;_++)this.trigger("change:"+l[_],this,p[l[_]],n)}if(h)return this;if(!c)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},rel:function(t,e){var n=this._links[t]||{};if(!n)throw new Error("No such rel found");if(n.templated){if(e)return n.template.expand(e);throw new Error("No data provided to expand templated uri")}return this._links[t].href?this._links[t].href:this._links[t]},rels:function(){return this._links},fullyQualifiedRel:function(t){var e=t.split(":");return this._curies[e[0]].expand({rel:e[1]})},control:function(t){var e;if(this._links[t]){var n=this._links[t].href.split(/\//g);("#controls"===n[0]||"#_controls"===n[0]||"#control"===n[0])&&(n=n.slice(1)),e=this._controls.get(n.join("."))}else e=this._controls.get(t);return e?e:null}}),a.extend=i.extend,n.exports.Model=a,n.exports.Collection=o}),t.register("extended-view",function(t,e,n){var r=e("hyperbone-view"),i=e("dom");r.use({templateHelpers:{pluralise:function(t,e){return 1===t?e:e+"s"},"if":function(t,e){return t?e:""}},attributeHandlers:{dblclicktoedit:function(t,e){var n=this,r=i(t).find("label"),o=i(t).find("input.edit");r.on("dblclick",function(){n.model.trigger(e,n.model,!0),o.els[0].focus()}),o.on("keypress",function(t){13==t.which&&n.model.trigger(e,n.model,!1)}).on("blur",function(){n.model.trigger(e,n.model,!1)})}}}),n.exports=r.HyperboneView}),t.register("filter-model",function(t,e,n){n.exports.Filter=e("hyperbone-model").Model.extend({defaults:{selected:!1},makeActive:function(){this.set("selected",!0)},makeInactive:function(){this.get("selected")&&this.set("selected",!1)}})}),t.register("todo-model",function(t,e,n){n.exports.ToDoItem=e("hyperbone-model").Model.extend({defaults:{completed:!1,task:"A task"},toggleEdit:function(t){this.set("editing",t)}})}),t.register("app-model",function(t,e,n){var r=e("hyperbone-model").Model.extend({_prototypes:{items:e("todo-model").ToDoItem,filters:e("filter-model").Filter},defaults:{remaining:0,completed:0,"has-items":!1,items:[],filters:[{_links:{self:{href:"/#!/all"}},selected:"selected",description:"All"},{_links:{self:{href:"/#!/active"}},selected:"",description:"Active"},{_links:{self:{href:"/#!/completed"}},selected:"",description:"Completed"}]},clearCompleted:function(){var t=[];this.get("items").each(function(e){e.get("completed")&&t.push(function(){e.destroy()})}),t.forEach(function(t){t()})},toggleAll:function(){this.get("items").each(function(t){t.set("completed",!t.get("completed"))})},addNewItem:function(){var t=this.get("new-task");t&&(this.get("items").add({task:t}),this.set("new-task",""))},updateTotals:function(){var t=this.get("items").length,e=this.get("items").select(function(t){return t.get("completed")}).length;this.set("completed",e),this.set("remaining",t-e),this.set("has-items",t?!0:!1)}});n.exports.AppModel=r}),t.register("todomvc-hyperbone",function(t,e){var n=function(){window.model=new(e("app-model").AppModel),new(e("extended-view"))({model:model,el:"#todoapp"}),model.on({"change:new-task":function(){model.addNewItem()},"toggle-all":function(){model.toggleAll()},"clear-completed":function(){model.clearCompleted()},"remove:items change:items":function(){model.updateTotals()},"edit:items":function(t,e){t.toggleEdit(e)},"filters-changed:filters":function(t){model.get("filters").each(function(t){t.makeInactive()}),t.makeActive()}})};new n}),t("todomvc-hyperbone")}();
//# sourceMappingURL=todomvc.min.js.map